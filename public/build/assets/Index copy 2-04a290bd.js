import{_ as G}from"./AuthenticatedLayout-cb5bc9f2.js";import"./index.es-2a630ddc.js";import{D as K,a as Q,X as W,n as Z,E as $,P as ee,b as A,J as I,m as L,c as s,d as l,w as e,F as f,r as u,o as a,e as te,f as w,g as m,t as g,h as _,i as h,j as ae}from"./app-af2088fa.js";import{h as ne}from"./moment-fbc5633a.js";import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";import{P as ie}from"./PlusCircleOutlined-c46a5e36.js";import{M as oe}from"./MoreOutlined-dcafcb15.js";const se=[{title:"Name",key:"name",dataIndex:"name",sorter:!0,width:"20%"},{title:"Attendance Status",key:"status",width:"20%"},{title:"Late Status",key:"latestatus",width:"10%"},{title:"Action",key:"manualaction",width:"30%"}],ue=[{title:"Location",key:"location",dataIndex:""},{title:"In",key:"in",dataIndex:"checkin"},{title:"Out",key:"out",dataIndex:"checkout"},{title:"Break",key:"break",dataIndex:""},{title:"Notes",key:"notes",dataIndex:""},{title:"Action",key:"action",dataIndex:""}],de={components:{AuthenticatedLayout:G,DownloadOutlined:K,PlusCircleOutlined:ie,MoreOutlined:oe,DeleteOutlined:Q,Head:W,Link:Z,EditOutlined:$},props:{date:String,employees:Object,breaks:Object,branches:Object,pagination:Object,errors:Object},setup(n){return{columns:se,innercolumns:ue}},data(n){const b=ee({term:"",date:n.date,branch:null});return{moment:ne,editableData:[],statusColor:{Present:"green",Absent:"red","Paid Leave":"blue","Unpaid Leave":"orange","Day Off":"purple"},page:1,pageSize:50,loading:!1,delayTime:1500,formState:b,showmanualsave:[]}},methods:{search(){this.$inertia.get("/attendance",{s:this.formState.term,date:this.formState.date,branch:this.formState.branch,pageSize:this.pageSize},{preserveState:!0})},handleTableChange(n){this.page=n.current,this.pageSize=n.pageSize,console.log(n),this.$inertia.get("/attendance",{s:this.formState.term,date:this.formState.date,branch:this.formState.branch,page:n.current,pageSize:n.pageSize},{preserveState:!0})},clockIn(n){this.loading=!0,A.post(route("attendance.clockin"),{...n,date:this.formState.date}).then(i=>{console.log(i),this.$inertia.get("/attendance",{s:this.formState.term,date:this.formState.date,branch:this.formState.branch,page:this.page,pageSize:this.pageSize},{preserveState:!0})}).finally(()=>{this.loading=!1})},clockOut(n){this.loading=!0,A.post(route("attendance.clockout"),{...n,date:this.formState.date}).then(i=>{console.log(i),this.$inertia.get("/attendance",{s:this.formState.term,date:this.formState.date,branch:this.formState.branch,page:this.page,pageSize:this.pageSize},{preserveState:!0})}).finally(()=>{this.loading=!1})},addBreak(n,i){this.loading=!0,A.post(route("attendance.addbreak"),{...n,date:this.formState.date,breakid:i}).then(o=>{console.log(o),this.$inertia.get("/attendance",{s:this.formState.term,date:this.formState.date,branch:this.formState.branch,page:this.page,pageSize:this.pageSize},{preserveState:!0})}).finally(()=>{this.loading=!1})},edit(n){this.editableData.push(n)},cancel(n){const i=this.editableData.indexOf(n);i>-1&&this.editableData.splice(i,1)},savehistory(n){var i=route("attendance.updatehistory");I.post(i,n,{onStart:o=>{this.loading=!0},onSuccess:o=>{this.cancel(n.id)},onError:o=>{this.loading=!1,Object.keys(o).forEach(function(b){L.error(o[b])})},onFinish:o=>{this.loading=!1}})},deletehistory(n){I.post(route("attendance.deletehistory",n),{},{onStart:i=>{this.loading=!0},onSuccess:i=>{},onFinish:i=>{this.loading=!1}})},addmanualrows(n){n.history.push({employee_id:n.employee_id,attdate:n.attdate,id:"",checkin:"",checkout:"",breakid:"",notes:""}),this.showmanualsave.push(n.employee_id)},savemanualdata(n){var i=route("attendance.addmultiplehistory");I.post(i,n,{onStart:o=>{this.loading=!0},onSuccess:o=>{},onError:o=>{this.loading=!1,Object.keys(o).forEach(function(b){L.error(o[b])})},onFinish:o=>{this.loading=!1}})},deletemanualrow(n,i){const o=this.employees.indexOf(n);if(o>-1){const b=this.employees[o].history.indexOf(i);this.employees[o].history.splice(b,1)}}}},ce={key:0},re={key:1},me={key:1},he={key:1},pe={key:1},_e={key:1},ye={key:1},ke={class:"editable-row-operations"},fe={key:0},ge={key:1};function ve(n,i,o,b,d,y){const j=u("Head"),T=u("a-spin"),O=u("a-select-option"),x=u("a-select"),S=u("a-form-item"),Y=u("a-date-picker"),U=u("a-input"),k=u("a-button"),F=u("a-form"),M=u("a-avatar"),D=u("a-tag"),N=u("a-menu-item"),P=u("a-menu"),V=u("DownOutlined"),J=u("a-dropdown"),C=u("a-space"),H=u("a-time-picker"),z=u("a-popconfirm"),R=u("EditOutlined"),B=u("DeleteOutlined"),E=u("a-table"),X=u("a-layout-content"),q=u("AuthenticatedLayout");return a(),s(f,null,[l(j,{title:"Employees"}),l(q,null,{default:e(()=>[l(T,{spinning:d.loading,delay:d.delayTime},null,8,["spinning","delay"]),l(X,{style:te({margin:"24px 16px",padding:"24px",background:"#fff",minHeight:"calc(100vh - 115px)",textAlign:"center"})},{default:e(()=>[l(C,{direction:"vertical",style:{width:"100%"}},{default:e(()=>[l(F,{name:"nest-messages",model:d.formState,layout:"inline",onFinish:y.search},{default:e(()=>[l(S,null,{default:e(()=>[l(x,{value:d.formState.branch,"onUpdate:value":i[0]||(i[0]=p=>d.formState.branch=p),placeholder:"Select Branch",style:{"min-width":"200px"}},{default:e(()=>[(a(!0),s(f,null,w(o.branches,p=>(a(),h(O,{value:p.id},{default:e(()=>[m(g(p.branch_name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["value"])]),_:1}),l(S,null,{default:e(()=>[l(Y,{value:d.formState.date,"onUpdate:value":i[1]||(i[1]=p=>d.formState.date=p),format:"DD-MM-YYYY","value-format":"YYYY-MM-DD"},null,8,["value"])]),_:1}),l(S,null,{default:e(()=>[l(U,{placeholder:"Search Employees",value:d.formState.term,"onUpdate:value":i[2]||(i[2]=p=>d.formState.term=p)},null,8,["value"])]),_:1}),l(S,null,{default:e(()=>[l(k,{type:"primary","html-type":"submit"},{default:e(()=>[m(" Search ")]),_:1})]),_:1}),l(S,null,{default:e(()=>[l(k,{type:"primary"},{default:e(()=>[m(" Add Time Manually ")]),_:1})]),_:1})]),_:1},8,["model","onFinish"]),l(E,{columns:b.columns,"row-key":p=>p.employee_id,"data-source":o.employees,pagination:o.pagination,loading:d.loading,onChange:y.handleTableChange},{bodyCell:e(({column:p,text:v,record:c})=>[p.key==="name"?(a(),s(f,{key:0},[l(M,{style:{color:"#f56a00","background-color":"#fde3cf"}},{default:e(()=>[m(g(v[0].toUpperCase()),1)]),_:2},1024),m(" Â  "+g(v),1)],64)):_("",!0),p.key==="status"?(a(),h(D,{key:1,color:d.statusColor[c.status]},{default:e(()=>[m(g(c.status),1)]),_:2},1032,["color"])):_("",!0),p.key==="latestatus"?(a(),s(f,{key:2},[c.status=="Present"?(a(),h(D,{key:0,color:c.late==!0?"red":"green"},{default:e(()=>[m(g(c.late==!0?"Late":"On Time"),1)]),_:2},1032,["color"])):_("",!0)],64)):_("",!0),p.key==="autoaction"?(a(),h(C,{key:3,direction:"horizontal"},{default:e(()=>[c.history.length?(a(),s("div",ce,[c.history[c.history.length-1].checkout!=null?(a(),h(k,{key:0,type:"primary",onClick:t=>y.clockIn(c)},{default:e(()=>[m("Clock In")]),_:2},1032,["onClick"])):_("",!0),c.history[c.history.length-1].checkout==null?(a(),h(k,{key:1,onClick:t=>y.clockOut(c)},{default:e(()=>[m("Clock Out")]),_:2},1032,["onClick"])):_("",!0),c.history[c.history.length-1].breakid==null?(a(),h(J,{key:2},{overlay:e(()=>[l(P,null,{default:e(()=>[(a(!0),s(f,null,w(o.breaks,t=>(a(),h(N,{key:t.id,onClick:r=>y.addBreak(c,t.id)},{default:e(()=>[m(g(t.name),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),default:e(()=>[l(k,null,{default:e(()=>[m(" Break "),l(V)]),_:1})]),_:2},1024)):(a(),h(k,{key:3,onClick:t=>y.clockOut(c)},{default:e(()=>[m("Close Break")]),_:2},1032,["onClick"]))])):(a(),s("div",re,[l(k,{type:"primary",onClick:t=>y.clockIn(c)},{default:e(()=>[m("Clock In")]),_:2},1032,["onClick"])]))]),_:2},1024)):_("",!0),p.key==="manualaction"?(a(),s(f,{key:4},[l(k,{type:"default",danger:"",onClick:t=>y.addmanualrows(c)},{default:e(()=>[m("Add Attendance")]),_:2},1032,["onClick"]),d.showmanualsave.includes(c.employee_id)?(a(),h(k,{key:0,type:"primary",danger:"",onClick:t=>y.savemanualdata(c)},{default:e(()=>[m("Save Attendance")]),_:2},1032,["onClick"])):_("",!0)],64)):_("",!0)]),expandedRowRender:e(({record:p})=>[l(E,{class:"table-sm",pagination:!1,columns:b.innercolumns,"row-key":v=>v.id,"data-source":p.history,set:n.parentrecord=p},{bodyCell:e(({column:v,text:c,record:t})=>[v.key==="location"?(a(),s(f,{key:0},[t.id==""||d.editableData.includes(t.id)?(a(),h(x,{key:0,value:t.branchid,"onUpdate:value":r=>t.branchid=r,placeholder:"Select Branch",style:{"min-width":"200px"}},{default:e(()=>[(a(!0),s(f,null,w(o.branches,r=>(a(),h(O,{value:r.id},{default:e(()=>[m(g(r.branch_name),1)]),_:2},1032,["value"]))),256))]),_:2},1032,["value","onUpdate:value"])):(a(),s("div",me,g(t.branch.branch_name??"-"),1))],64)):_("",!0),v.key==="in"?(a(),s(f,{key:1},[t.id==""||d.editableData.includes(t.id)?(a(),h(H,{key:0,allowClear:!0,format:"hh:mm A",placeholder:"Check In","value-format":"HH:mm:ss",value:t.checkin,"onUpdate:value":r=>t.checkin=r},null,8,["value","onUpdate:value"])):(a(),s("div",he,g(d.moment(t.checkin,"HH:mm:ss").format("hh:mm A")),1))],64)):_("",!0),v.key==="out"?(a(),s(f,{key:2},[t.id==""||d.editableData.includes(t.id)?(a(),h(H,{key:0,allowClear:!0,format:"hh:mm A",placeholder:"Check Out","value-format":"HH:mm:ss",value:t.checkout,"onUpdate:value":r=>t.checkout=r},null,8,["value","onUpdate:value"])):(a(),s("div",pe,g(t.checkout!=null?d.moment(t.checkout,"HH:mm:ss").format("hh:mm A"):"-"),1))],64)):_("",!0),v.key==="break"?(a(),s(f,{key:3},[t.id==""||d.editableData.includes(t.id)?(a(),h(x,{key:0,allowClear:!0,value:t.breakid,"onUpdate:value":r=>t.breakid=r,style:"width: 150px"},{default:e(()=>[(a(!0),s(f,null,w(o.breaks,r=>(a(),h(O,{value:r.id},{default:e(()=>[m(g(r.name),1)]),_:2},1032,["value"]))),256))]),_:2},1032,["value","onUpdate:value"])):(a(),s("div",_e,[t.breakid!=null?(a(),h(D,{key:0,color:"blue"},{default:e(()=>[m(g(t.break.name),1)]),_:2},1024)):_("",!0)]))],64)):_("",!0),v.key==="notes"?(a(),s(f,{key:4},[t.id==""||d.editableData.includes(t.id)?(a(),h(U,{key:0,value:t.notes,"onUpdate:value":r=>t.notes=r,style:{width:"100%"}},null,8,["value","onUpdate:value"])):(a(),s("span",ye,g(t.notes),1))],64)):_("",!0),v.key==="action"?(a(),s(f,{key:5},[t.id!=""?(a(),h(C,{key:0,direction:"horizontal"},{default:e(()=>[ae("div",ke,[t.id==""||d.editableData.includes(t.id)?(a(),s("span",fe,[l(k,{type:"primary",onClick:r=>y.savehistory(t)},{default:e(()=>[m("Save")]),_:2},1032,["onClick"]),l(z,{title:"Sure to cancel?",onConfirm:r=>y.cancel(t.id)},{default:e(()=>[l(k,{type:"default"},{default:e(()=>[m("Cancel")]),_:1})]),_:2},1032,["onConfirm"])])):(a(),s("span",ge,[l(k,{onClick:r=>y.edit(t.id)},{icon:e(()=>[l(R)]),_:2},1032,["onClick"])]))]),l(z,{title:"Sure to delete?",onConfirm:r=>y.deletehistory(t.id)},{default:e(()=>[l(k,null,{icon:e(()=>[l(B)]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):(a(),h(C,{key:1},{default:e(()=>[l(z,{title:"Sure to delete?",onConfirm:r=>y.deletemanualrow(n.parentrecord,t)},{default:e(()=>[l(k,null,{icon:e(()=>[l(B)]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024))],64)):_("",!0)]),_:2},1032,["columns","row-key","data-source","set"])]),_:1},8,["columns","row-key","data-source","pagination","loading","onChange"])]),_:1})]),_:1},8,["style"])]),_:1})],64)}const ze=le(de,[["render",ve]]);export{ze as default};
